id: CVE-2023-ETHERSCAN

info:
  name: Exposed Etherscan API Key
  author: intelligent-ears
  severity: medium
  description: Detects exposed Etherscan API keys in configuration files or environment variables.
  reference:
    - https://etherscan.io/apis
  tags: cve,etherscan,api-key,exposure

requests:
  - method: GET
    path:
      - "{{BaseURL}}/.env"
      - "{{BaseURL}}/config.json"
      - "{{BaseURL}}/hardhat.config.js"
      - "{{BaseURL}}/truffle-config.js"
      - "{{BaseURL}}/README.md"

    matchers-condition: or
    matchers:
      - type: regex
        part: body
        regex:
          - "ETHERSCAN_API_KEY=[A-Z0-9]{34}"
          - "etherscan_api_key:\\s*['\"][A-Z0-9]{34}['\"]"
        condition: or

      - type: word
        part: body
        words:
          - "ETHERSCAN_API_KEY="
          - "etherscan_api_key:"
        condition: or
