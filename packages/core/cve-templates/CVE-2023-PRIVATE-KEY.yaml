id: CVE-2023-PRIVATE-KEY

info:
  name: Exposed Private Keys
  author: intelligent-ears
  severity: critical
  description: Detects exposed Ethereum private keys in configuration files, scripts, or documentation.
  reference:
    - https://docs.ethers.org/v5/api/signer/
  tags: cve,private-key,critical,exposure

requests:
  - method: GET
    path:
      - "{{BaseURL}}/.env"
      - "{{BaseURL}}/config.json"
      - "{{BaseURL}}/secrets.json"
      - "{{BaseURL}}/hardhat.config.js"
      - "{{BaseURL}}/deploy.js"
      - "{{BaseURL}}/README.md"

    matchers-condition: or
    matchers:
      - type: regex
        part: body
        regex:
          - "PRIVATE_KEY=0x[a-fA-F0-9]{64}"
          - "private_key:\\s*['\"]0x[a-fA-F0-9]{64}['\"]"
          - "privateKey:\\s*['\"]0x[a-fA-F0-9]{64}['\"]"
        condition: or

      - type: word
        part: body
        words:
          - "PRIVATE_KEY=0x"
          - "private_key: \"0x"
          - "privateKey: \"0x"
        condition: or

      - type: dsl
        dsl:
          - "contains(body, 'PRIVATE_KEY=')"
          - "contains(body, 'privateKey:')"
        condition: or
